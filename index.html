<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Party RSVP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="You're invited! RSVP in one tap." />
  <style>
    :root{
      --bg:#0b0d16; --card:#12172a; --text:#eef0f6; --muted:#a7afc3;
      --accent:#2b8eff; --ok:#34d399; --no:#fb7185; --maybe:#fbbf24;
      --border:rgba(255,255,255,.08);
    }
    /* Global */
    html{scroll-behavior:smooth}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
      color:var(--text); background:var(--bg);
    }
    a{color:inherit}

    /* Container */
    .wrap{max-width:720px; margin:0 auto; padding:16px}
    .topbar{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(6px);
      background:linear-gradient(180deg, rgba(18,23,42,.85), rgba(18,23,42,.35));
      border-bottom:1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:10px 12px; margin-bottom:12px; border-radius:0 0 16px 16px;
    }
    .brand{font-weight:700; letter-spacing:.3px}
    .cta{
      border:1px solid var(--border); background:var(--accent); color:white;
      padding:10px 14px; border-radius:999px; font-weight:700; cursor:pointer;
    }

    /* Hero image block */
    .hero{
      border:1px solid var(--border); border-radius:18px; overflow:hidden;
      background:#000; margin-bottom:14px;
    }
    .hero figure{margin:0; display:grid; place-items:center; background:#000}
    .hero img{
      display:block; width:100%; height:auto; object-fit:contain; object-position:center;
      aspect-ratio:auto; /* respect PNG‚Äôs natural ratio */
    }
    .hero .meta{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      padding:10px 12px; font-size:13px; color:var(--muted);
      border-top:1px solid var(--border); background:#0e1428;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px; border:1px solid var(--border);
      background:#0d1326; color:var(--text); font-size:12px; text-decoration:none;
      white-space:nowrap;
    }

    /* Card (RSVP) */
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:16px; display:grid; gap:14px;
    }
    .choices{display:flex; gap:10px; flex-wrap:wrap}
    .choice{
      flex:1 1 110px; text-align:center; padding:12px; border-radius:12px; cursor:pointer;
      border:1px solid var(--border); user-select:none; font-weight:600;
      background:linear-gradient(180deg, #111936, #0e142a);
    }
    .choice[data-val="Yes"]{box-shadow: inset 0 0 0 1px rgba(52,211,153,.35)}
    .choice[data-val="Maybe"]{box-shadow: inset 0 0 0 1px rgba(251,191,36,.35)}
    .choice[data-val="No"]{box-shadow: inset 0 0 0 1px rgba(251,113,133,.35)}
    .choice.active{outline:2px solid var(--accent); outline-offset:2px}

    label{font-size:13px; color:var(--muted)}
    input, textarea{
      width:100%; box-sizing:border-box; background:#0b1022; color:var(--text);
      border:1px solid var(--border); border-radius:12px; padding:12px;
      outline:none; font-size:16px;
    }
    input:focus, textarea:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(43,142,255,.2)}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{
      padding:12px 16px; border-radius:12px; border:1px solid var(--border);
      background:linear-gradient(180deg, #1a2140, #141a2d); color:var(--text);
      cursor:pointer; font-weight:700;
    }
    .btn.primary{background:linear-gradient(180deg, #2b8eff, #1a6add); border-color:#1b4ea1; color:#fff}
    .hint{font-size:12px; color:var(--muted)}
    .success, .error{padding:12px 14px; border-radius:12px; font-size:14px; display:none}
    .success{background:rgba(52,211,153,.12); border:1px solid rgba(52,211,153,.35)}
    .error{background:rgba(251,113,133,.12); border:1px solid rgba(251,113,133,.35)}
    .hide{display:none}

    /* Desktop niceties */
    @media (min-width:900px){
      .wrap{max-width:900px}
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="brand">üéâ Party Invite</div>
    <a class="cta" href="#rsvp">RSVP</a>
  </div>

  <main class="wrap">
    <!-- HERO: random image each load -->
    <section class="hero" id="hero">
      <figure>
        <img id="flyer" src="" alt="Party Flyer">
      </figure>
      <div class="meta">
        <a class="pill" target="_blank" rel="noopener"
           href="https://www.google.com/maps?q=5+Keith+Road,+Hopatcong,+NJ+07843">üìç 5 Keith Road, Hopatcong, NJ 07843</a>
        <span>Tap RSVP below</span>
      </div>
    </section>

    <!-- RSVP CARD -->
    <section id="rsvp" class="card" aria-labelledby="rsvpTitle">
      <h2 id="rsvpTitle" style="margin:0">RSVP</h2>

      <!-- choices -->
      <input type="hidden" name="rsvp" id="rsvpInput" />
      <div class="choices" role="group" aria-label="RSVP options">
        <button type="button" class="choice" data-val="Yes">‚úÖ Yes, I‚Äôm in</button>
        <button type="button" class="choice" data-val="Maybe">ü§î I‚Äôll think about it</button>
        <button type="button" class="choice" data-val="No">‚ùå Sorry, I‚Äôm out</button>
      </div>

      <!-- form -->
      <form id="rsvpForm" method="POST" novalidate>
        <div class="row" style="gap:12px; flex-wrap:wrap">
          <div style="flex:1 1 200px">
            <label for="name">Your name *</label>
            <input type="text" id="name" name="name" required />
          </div>
          <div style="flex:1 1 200px">
            <label for="phone">Phone *</label>
            <input type="tel" id="phone" name="phone" required placeholder="We‚Äôll hit you up if anything changes" />
          </div>
        </div>

        <div>
          <label for="guests"># of guests</label>
          <input type="number" min="1" max="20" id="guests" name="guests" value="1" />
        </div>

        <div>
          <label for="music">What music do you want to play?</label>
          <textarea id="music" name="music" rows="2" placeholder="List songs, genres, or artists you want to hear"></textarea>
        </div>

        <div>
          <label for="notes">Notes</label>
          <textarea id="notes" name="notes" rows="3"
            placeholder="What drinks do you like? üçπ&#10;What costume are you gonna wear? üé≠"></textarea>
        </div>

        <input type="text" name="_gotcha" class="hide" autocomplete="off" />
        <div class="row">
          <button class="btn primary" type="submit">Submit RSVP</button>
          <span class="hint">No reload‚Äîconfirmation shows below.</span>
        </div>

        <div id="success" class="success" role="status">Thanks! Your RSVP was received. üéâ</div>
        <div id="error" class="error" role="alert">Hmm, something went wrong. Please try again.</div>
      </form>
    </section>
  </main>

  <script>
    /* ====== Paste your Apps Script Web App URL here ====== */
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxm5IR4VIIriwVCZDBA2eSJKQUjNj18ipJdHwtVFeFEuOeOFM0Dkskk2XRbNkeEX3Y66Q/exec";
    /* ===================================================== */

    // 1) RANDOM HERO IMAGE (one of 3.png, 4.png, 5.png each load)
    const IMAGES = ["./3.png", "./4.png", "./5.png"];
    const flyer = document.getElementById('flyer');
    const randomSrc = IMAGES[Math.floor(Math.random() * IMAGES.length)];
    flyer.src = randomSrc;

    // 2) RSVP choices
    const choices = document.querySelectorAll('.choice');
    const rsvpInput = document.getElementById('rsvpInput');
    choices.forEach(c => {
      c.addEventListener('click', () => {
        choices.forEach(x => x.classList.remove('active'));
        c.classList.add('active');
        rsvpInput.value = c.dataset.val;
      });
    });

    // 3) Form submit (AJAX to Apps Script)
    const form = document.getElementById('rsvpForm');
    const successEl = document.getElementById('success');
    const errorEl = document.getElementById('error');

    document.addEventListener('DOMContentLoaded', () => { form.action = WEB_APP_URL; });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      successEl.style.display = 'none';
      errorEl.style.display = 'none';

      // Simple required checks
      const requiredMissing = [];
      if (!rsvpInput.value) requiredMissing.push('RSVP choice');
      if (!form.name.value.trim()) requiredMissing.push('name');
      if (!form.phone.value.trim()) requiredMissing.push('phone');

      if (requiredMissing.length){
        errorEl.textContent = 'Please fill: ' + requiredMissing.join(', ') + '.';
        errorEl.style.display = 'block';
        return;
      }

      try {
        const res = await fetch(form.action, {
          method: 'POST',
          body: new FormData(form),
          headers: { 'Accept': 'application/json' }
        });

        if (res.ok) {
          form.reset();
          choices.forEach(x => x.classList.remove('active'));
          rsvpInput.value = '';
          successEl.style.display = 'block';
          // Scroll success into view (SPA feel)
          successEl.scrollIntoView({behavior:'smooth', block:'center'});
        } else {
          errorEl.style.display = 'block';
          errorEl.scrollIntoView({behavior:'smooth', block:'center'});
        }
      } catch (err) {
        errorEl.style.display = 'block';
        errorEl.scrollIntoView({behavior:'smooth', block:'center'});
      }
    });
  </script>
</body>
</html>
